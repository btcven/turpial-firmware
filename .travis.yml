dist: xenial
language: python
python:
  - '3.8'
os: 
  - linux

addons:
  apt:
    packages:
      - git
      - wget
      - make
      - gperf
      - python
      - python-serial
      - python-future
      - python-cryptography
      - python-pyparsing
      - libncurses-dev
      - flex
      - bison

before_install:
- sudo apt-get -y install doxygen
# Save path to the git respository
- PROJECT_PATH=$(pwd)

install:
- pip install -U travis-sphinx
- pip install -U sphinx-rtd-theme
- pip install -U breathe
- pip install -U exhale
# Install ESP32 toochain following steps as desribed
# in https://docs.espressif.com/projects/esp-idf/en/latest/get-started/#get-started-get-prerequisites
- mkdir -p ~/esp
- cd ~/esp
- git clone --recursive https://github.com/espressif/esp-idf.git
- cd ~/esp/esp-idf
- ./install.sh
- export IDF_PATH=~/esp/esp-idf
- export PATH=$PATH:$HOME/esp/esp-idf/tools
- . $HOME/esp/esp-idf/export.sh

jobs:
  include:
    stage: "Documentation"
    name: "Documentatiom Deploy"
    script:
      - cd $PROJECT_PATH
      - travis-sphinx build --nowarn --source doc/

    stage: "Build"
    name: "Build Firmware"
    script: 
      - cd $PROJECT_PATH
      - idf.py build
      


